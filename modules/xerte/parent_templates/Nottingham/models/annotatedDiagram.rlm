	<PG title="Annotated Diagram" name="annotatedDiagram">		<SCR name="getPageID"><![CDATA[pageIcon = icon.parentNode.clip();if (rootIcon.projMode == "dev"){   // Page Wizard  pageIcon.templateData = pageIcon.extXML.toObject();  pageIcon.templateData = pageIcon.templateData.pageWizard[0];} else {  // Toolkits  myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);  pageIcon.templateData = myXML.toObject();}  rootIcon.setTitleText(templateData.learningObject[0].name);  // handle multiple page data definitions in a project if (rootIcon.projectPageIndex == undefined){     rootIcon.projectPageIndex = 0;}// check if this page has a definition for the current project index and default to 0 if notif (pageIcon.templateData.annotatedDiagram[rootIcon.projectPageIndex].name == undefined){  projPI = 0;} else {  projPI = rootIcon.projectPageIndex; }  currentIndex = -1;col = pageIcon.templateData.annotatedDiagram[projPI].colour;if (pageIcon.templateData.annotatedDiagram[projPI].narration != undefined){  narration = pageIcon.templateData.annotatedDiagram[projPI].narration;  rootIcon.broadcast('showAudio');}]]></SCR>		<DIS h="474" w="760" tabIndex="-1" id="panel" name="panel" x="20" y="20" type="ext" url="templatePath + 'common/whitePanel.swf'"><![CDATA[]]></DIS>		<SCR name="makeLabels"><![CDATA[hsCount = pageIcon.templateData.annotatedDiagram[projPI].hotspot.length;if (!hsCount > 0){  hsCount = 0;}if (icon.attributes.built != "true"){  //build hotspots  if (hsCount > 0){    icon.nextSibling.getChildByName('protoLabel').duplicate(pageIcon.templateData.annotatedDiagram[projPI].hotspot.length - 1);  } else {    icon.nextSibling.getChildByName('protoLabel').removeNode();  }  //build hotspotGroups  if (pageIcon.templateData.annotatedDiagram[projPI].hotspotGroup.length > 0){    icon.nextSibling.getChildByName('protoGroupLabel').duplicate(pageIcon.templateData.annotatedDiagram[projPI].hotspotGroup.length - 1);  } else {    icon.nextSibling.getChildByName('protoGroupLabel').removeNode();  }}icon.attributes.built = "true";hsData = pageIcon.templateData.annotatedDiagram[projPI];shape = pageIcon.templateData.annotatedDiagram[projPI].shape;]]></SCR>		<DEC id="labels" name="imageAndLabels" repeat="all" branch="sequence" pause="0" erase="0" eraseOnExit="0">			<PG id="imagePage" name="image">				<DIS toolTip="{pageIcon.templateData.annotatedDiagram[projPI].tip}" id="graphic" name="graphic" x="260" y="30" type="ext" url="{pageIcon.templateData.annotatedDiagram[projPI].url}"><![CDATA[]]></DIS>				<DIS id="drawing" name="drawing" x="0" y="0" w="400" h="10" type="text"><![CDATA[]]></DIS>				<INT id="graphicLoader" name="graphicLoader" perpetual="0">					<RES name="onLoad" type="event" eventName="onLoad" icon="graphic" erase="1" exit="1">						<SCR name="resize"><![CDATA[//resize the image if it's too big or too wideif (pageIcon.templateData.annotatedDiagram[projPI].align != 'Top'){    p = graphic._width / graphic._height;  maxWidth = 500;  maxHeight = 454;  scale = 1;  initHeight = graphic._height;  initWidth = graphic._width;    graphic.constrain(maxWidth, maxHeight);    scale = graphic._width / initWidth;    graphic._x = 770 - graphic._width;  textY = 30;  textW = 800 - graphic._width - 80; } else { //top layout  p = graphic._width / graphic._height;  maxWidth = 740;  maxHeight = 250;  scale = 1;  initHeight = graphic._height;  initWidth = graphic._width;    graphic.constrain(maxWidth, maxHeight);    scale = graphic._width / initWidth;    graphic._x = 770 - graphic._width;  textY = graphic._height + 50;  textW = 260;}]]></SCR>					</RES>				</INT>				<DIS textColour="#333333" id="introTxt" h="10" name="text" x="30" y="textY" w="textW" type="text"><![CDATA[{pageIcon.templateData.annotatedDiagram[projPI].text}]]></DIS>				<SCR name="initNextY"><![CDATA[nextY = introTxt._y + introTxt._height + 10;]]></SCR>			</PG>			<PG name="protoLabel">				<SCR name="setID"><![CDATA[icon.nextSibling.attributes.id = 'lbl' + labels.getPageIndex();icon.parentNode.lastChild.firstChild.attributes.icon = 'lbl' + labels.getPageIndex();]]></SCR>				<DIS textColour="#000000" id="lbl" name="label" x="30" y="nextY" w="200" h="10" type="text"><![CDATA[{'<b>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[icon.parentNode.index() - 1].name + '</b>'}]]></DIS>				<SCR name="nextY"><![CDATA[nextY += engine['lbl' + labels.getPageIndex()]._height;]]></SCR>				<INT name="clickHandler" perpetual="1">					<RES name="showInfo" type="event" eventName="onRelease" icon="lbl" erase="1" exit="0">						<SCR name="showInfo"><![CDATA[nfo.removeMovieClip();currentIndex = labels.getPageIndex() - 1;tempLbl.clear();if (pageIcon.templateData.annotatedDiagram[projPI].align != 'Top'){    nfoX = 30;  nfoY = nextY + 20;  nfoW = textW - 10;  nfoH = 489 - nextY - 30;  pX = textW;} else {  nfoX = textW + 50;  nfoY = graphic._height + 50;  nfoW = 450;  nfoH = 514 - 90 - graphic._height;  pX = textW / 2;}]]></SCR>						<DIS scrolling="auto" textColour="#333333" id="nfo" name="information" x="nfoX" y="nfoY" w="nfoW" h="nfoH" type="text"><![CDATA[{'<b>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[currentIndex].name + '</b><br>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[currentIndex].text}]]></DIS>						<SCR name="showInfo"><![CDATA[//nfo.setText('<b>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[currentIndex].name + '</b><br>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[currentIndex].text);nfo.clear();nfo.beginFill(0xFFFFCC,100);nfo.lineStyle(0,0x666666,100);nfo.drawRect(-5, -5, nfoW + 10, 489 - nfo._y);nfo.fade('in', 0.3, 'None', 'easeNone',2);tempLbl = eval(icon.parentNode.attributes.icon);tempLbl.beginFill(col,60);tempLbl.drawRect(0,0,textW,20);destX = graphic._x + (Number(hsData.hotspot[currentIndex].x) + Number(hsData.hotspot[currentIndex].w) / 2) * scale;destY = graphic._y + (Number(hsData.hotspot[currentIndex].y) + Number(hsData.hotspot[currentIndex].h) / 2) * scale;destW = scale*(Number(hsData.hotspot[currentIndex].w) / 2);destH = scale*(Number(hsData.hotspot[currentIndex].h) / 2);drawing.clear();drawing.lineStyle(2,col,100);if (pageIcon.templateData.annotatedDiagram[projPI].align != 'Top'){    pX = tempLbl._x + tempLbl._width;} else {  px = (tempLbl._x + tempLbl._width) / 2;}drawing.moveTo(pX,tempLbl._y + 10);if (shape == "Oval"){  drawing.drawOval(destX,destY,destW,destH);} else if (shape == "Rectangle"){  drawing.drawRect(destX - destW, destY - destH, destW*2,destH*2);} else if (shape == "Arrow"){  drawing.beginFill(col,100);  drawing.arrowTo(tempLbl._x + tempLbl._width,tempLbl._y + 10,destX,destY);} else {  drawing.lineTo(destX,destY);}]]></SCR>					</RES>				</INT>			</PG>			<PG name="protoGroupLabel">				<SCR name="setID"><![CDATA[icon.nextSibling.attributes.id = 'lbl' + labels.getPageIndex();icon.parentNode.lastChild.firstChild.attributes.icon = 'lbl' + labels.getPageIndex();tempVar = icon.parentNode.index() - 1 - hsCount;//debug(tempVar);]]></SCR>				<DIS textColour="#000000" id="lbl" name="label" x="30" y="nextY" w="200" h="10" type="text"><![CDATA[{'<b>' + pageIcon.templateData.annotatedDiagram[projPI].hotspotGroup[tempVar].name + '</b>'}]]></DIS>				<SCR name="nextY"><![CDATA[nextY += engine['lbl' + labels.getPageIndex()]._height;]]></SCR>				<INT name="clickHandler" perpetual="1">					<RES name="showInfo" type="event" eventName="onRelease" icon="lbl" erase="1" exit="0">						<SCR name="showInfo"><![CDATA[currentIndex = labels.getPageIndex() - 1 - hsCount;tempLbl.clear();nfo.removeMovieClip();if (pageIcon.templateData.annotatedDiagram[projPI].align != 'Top'){    nfoX = 30;  nfoY = nextY + 20;  nfoW = textW - 10;  nfoH = 489 - nextY - 30;  pX = textW;} else {  nfoX = textW + 50;  nfoY = graphic._height + 50;  nfoW = 450;  nfoH = 514 - 90 - graphic._height;  pX = textW / 2;}]]></SCR>						<DIS scrolling="auto" textColour="#333333" id="nfo" name="information" x="nfoX" y="nfoY" w="nfoW" h="nfoH" type="text"><![CDATA[{'<b>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[currentIndex].name + '</b><br>' + pageIcon.templateData.annotatedDiagram[projPI].hotspot[currentIndex].text}]]></DIS>						<SCR name="[Untitled]"><![CDATA[nfo.setText('<b>' + pageIcon.templateData.annotatedDiagram[projPI].hotspotGroup[currentIndex].name + '</b><br>' + pageIcon.templateData.annotatedDiagram[projPI].hotspotGroup[currentIndex].text);nfo.clear();nfo.beginFill(0xFFFFCC,100);nfo.lineStyle(0,0x666666,100);nfo.drawRect(-5, -5, nfoW + 10, 489 - nfo._y);nfo.fade('in', 0.3, 'None', 'easeNone',2);tempLbl = eval(icon.parentNode.attributes.icon);tempLbl.beginFill(col,60);tempLbl.drawRect(0,0,textW,20);drawing.clear();drawing.lineStyle(2,col,100);groupData = pageIcon.templateData.annotatedDiagram[projPI].hotspotGroup[currentIndex];for (i = 0; i < groupData.hotspot.length; i++){    destX = graphic._x + (Number(groupData.hotspot[i].x) + Number(groupData.hotspot[i].w) / 2) * scale;  destY = graphic._y + (Number(groupData.hotspot[i].y) + Number(groupData.hotspot[i].h) / 2) * scale;  destW = scale*(Number(groupData.hotspot[i].w) / 2);  destH = scale*(Number(groupData.hotspot[i].h) / 2);  if (pageIcon.templateData.annotatedDiagram[projPI].align != 'Top'){      pX = tempLbl._x + tempLbl._width;  } else {    px = (tempLbl._x + tempLbl._width) / 2;  }  drawing.moveTo(pX,tempLbl._y + 10);    if (shape == "Oval"){    drawing.drawOval(destX,destY,destW,destH);  } else if (shape == "Rectangle"){    drawing.drawRect(destX - destW, destY - destH, destW*2,destH*2);  } else if (shape == "Arrow"){    drawing.beginFill(col,100);    drawing.arrowTo(tempLbl._x + tempLbl._width,tempLbl._y + 10,destX,destY);  } else {    drawing.lineTo(destX,destY);  }}]]></SCR>					</RES>				</INT>			</PG>		</DEC>	</PG>